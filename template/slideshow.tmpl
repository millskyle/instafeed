
<!doctype html>
<html>
<head>
   <meta charset="utf-8" />
   <title>Full Page Slideshow Demo 1</title>



<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-animate.min.js"></script>

<style>


.card {
  position: absolute;
  top:100px;
  left:100px;
}


/* now the element will fade out before it is removed from the DOM */
.fade.ng-leave {
     transition:0.5s linear all;
       opacity:1;
}
.fade.ng-leave.ng-leave-active {
     opacity:0;
}

/* The starting CSS styles for the enter animation */
.fade.ng-enter {
     transition:0.5s linear all;
       opacity:0;
}

/* The finishing CSS styles for the enter animation */
.fade.ng-enter.ng-enter-active {
     opacity:1;
}

</style>

</head>
<body ng-app="SlideshowApp" >


<div class="main" ng-controller="MainController" >
   <div class="card fade"  ng-repeat="image in images" ng-if="isCurrentSlideIndex($index)" >
      <img class='slide_image ' ng-src='{{ image.url }}'  />
   </div>
</div>









<script>
//app
var app = angular.module('SlideshowApp', ['ngAnimate' ]);


////services
//app.factory('getimages', ['$http', function($http) { 
//   return $http.get('./get_photos.json')
//            .success(function(data) { console.log('data'); return data; }) 
//            .error(function(err) { console.log('error');return err;  }); 
//}]);



//controllers
app.controller('MainController', ['$scope', '$timeout', '$http', function($scope, $timeout, $http) { 
  //   getimages.success(function(data) {
 //            $scope.images=data;
   //           console.log('first fire');
   //  });

  var INTERVAL = 5000;
  $scope.images = [];

  $scope.currentAnimation = 'fade-in-animation';




  function setCurrentSlideIndex(index) {
     $scope.currentIndex = index;
  }

  function isCurrentSlideIndex(index) {
     return $scope.currentIndex === index;
  }

  function nextSlide() {
      $scope.currentIndex = ($scope.currentIndex < $scope.images.length - 1) ? ++$scope.currentIndex : 0;
      $timeout(nextSlide, INTERVAL);
  }

  function loadSlides() {
     $timeout(nextSlide, INTERVAL);
  }

  $scope.currentIndex = 0;
  $scope.setCurrentSlideIndex = setCurrentSlideIndex;
  $scope.isCurrentSlideIndex = isCurrentSlideIndex;


  $scope.getData = function () {
      $http.get('./get_photos_static.json')
           .success(function(data) { console.log('fetched'); $scope.images = data; });
   };

  // Function to replicate setInterval using $timeout service.
  $scope.intervalFunction = function(){
    $timeout(function() {
      $scope.getData();
//getimages.success(function(data) { $scope.images=data;   });
      $scope.intervalFunction();
      console.log('fired');
    }, 20000) //time between fetching new images from server/instagram (in milliseconds)
  };

  // Kick off the interval
  $scope.intervalFunction();
  loadSlides();


       // ... 
}]);

app.animation('.fade-in-animation', function ($window) {
    return {
        enter: function (element, done) {
            TweenMax.fromTo(element, 1, { opacity: 0}, {opacity: 1, onComplete: done});
        },

        leave: function (element, done) {
            TweenMax.to(element, 1, {opacity: 0, onComplete: done});
        }
    };
});


</script>


</body>
</html>

