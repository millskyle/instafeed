
<!doctype html>
<html>
<head>
   <meta charset="utf-8" />
   <title>Full Page Slideshow Demo 1</title>



<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-animate.min.js"></script>

<link rel="stylesheet" type="text/css" href="slideshow.css">
<link href='https://fonts.googleapis.com/css?family=Lobster+Two' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Overlock' rel='stylesheet' type='text/css'>


</head>
<body ng-app="SlideshowApp" class='BODY'>


<div class="main" ng-controller="MainController" >

 <div class="cardholder" > 
   <div class="card fade"  ng-repeat="image in images" ng-if="isCurrentSlideIndex($index)" >
      <div class="column1">
         <img class='slide_image ' ng-src='{{ image.url }}' />
      </div>
      <div class="column2" >
         <div class='user'>
           <div class="profile-pic-container"><img ng-src="{{ image.profile_pic }} " class='profile-pic' /></div>
           <div class='username' > {{image.username}} </div>
         </div>
         <div class='likes' > <div class="heart"> {{image.likes}} </div></div>
         <div class='caption' > {{image.caption}} </div>
      </div >
   </div>

 </div>


</div>









<script>
//app
var app = angular.module('SlideshowApp', ['ngAnimate' ]);


////services
//app.factory('getimages', ['$http', function($http) { 
//   return $http.get('./get_photos.json')
//            .success(function(data) { console.log('data'); return data; }) 
//            .error(function(err) { console.log('error');return err;  }); 
//}]);



//controllers
app.controller('MainController', ['$scope', '$timeout', '$http', function($scope, $timeout, $http) { 
  //   getimages.success(function(data) {
 //            $scope.images=data;
   //           console.log('first fire');
   //  });

  var INTERVAL = 5000;
  $scope.images = [];

  $scope.currentAnimation = 'fade-in-animation';




  function setCurrentSlideIndex(index) {
     $scope.currentIndex = index;
  }

  function isCurrentSlideIndex(index) {
     return $scope.currentIndex === index;
  }

  function nextSlide() {
      $scope.currentIndex = ($scope.currentIndex < $scope.images.length - 1) ? ++$scope.currentIndex : 0;
      $timeout(nextSlide, INTERVAL);
  }

  function loadSlides() {
     $timeout(nextSlide, INTERVAL);
  }

  $scope.currentIndex = 0;
  $scope.setCurrentSlideIndex = setCurrentSlideIndex;
  $scope.isCurrentSlideIndex = isCurrentSlideIndex;


  $scope.getData = function () {
      $http.get('./get_photos_static.json')
           .success(function(data) { console.log('fetched'); $scope.images = data; });
   };

  // Function to replicate setInterval using $timeout service.
  $scope.intervalFunction = function(){
    $timeout(function() {
      $scope.getData();
//getimages.success(function(data) { $scope.images=data;   });
      $scope.intervalFunction();
      console.log('fired');
    }, 2000) //time between fetching new images from server/instagram (in milliseconds)
  };

  // Kick off the interval
  $scope.intervalFunction();
  loadSlides();


       // ... 
}]);

app.animation('.fade-in-animation', function ($window) {
    return {
        enter: function (element, done) {
            TweenMax.fromTo(element, 1, { opacity: 0}, {opacity: 1, onComplete: done});
        },

        leave: function (element, done) {
            TweenMax.to(element, 1, {opacity: 0, onComplete: done});
        }
    };
});


</script>


</body>
</html>

